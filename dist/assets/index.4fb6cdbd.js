var R=Object.defineProperty,W=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var p=(n,e,t)=>e in n?R(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,w=(n,e)=>{for(var t in e||(e={}))M.call(e,t)&&p(n,t,e[t]);if(b)for(var t of b(e))z.call(e,t)&&p(n,t,e[t]);return n},E=(n,e)=>W(n,L(e));var F=(n,e,t)=>(p(n,typeof e!="symbol"?e+"":e,t),t);import{j as v,r as i,E as J,m as d,D as B,a as _,c as x,T as N,b as T,B as y,d as K,e as U,f as V,g as X,p as C,P as q,C as H,h as G,i as Q,R as Y,k as Z,l as ee,n as te}from"./vendor.fabf2e23.js";const ne=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}};ne();const a=v.exports.jsx,f=v.exports.jsxs;class oe extends i.exports.Component{constructor(){super(...arguments);F(this,"state",{hasError:!1})}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){const{children:e}=this.props;return this.state.hasError?a("h1",{children:"\u30A8\u30E9\u30FC\u306E\u767A\u751F\u306F\u60F3\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093\uFF01"}):e}}const re=n=>{if(n.length!==16)throw new Error("Illegal board status!");return n.every((e,t)=>t<15&&e===t+1||t===15&&e===null)},O=(n,e)=>{var t;return(t=[e-4>=0?e-4:null,e+4<=15?e+4:null,e%4-1>=0?e-1:null,e%4+1<=3?e+1:null].find(r=>r!==null&&n[r]===null))!=null?t:null},se=n=>{var e;return(e=n.indexOf(null))!=null?e:null},k=(n,e,t)=>{console.log({brd:n,pos1:e,pos2:t});const r=[...n];return console.log({nbrd:JSON.stringify(r),pos1:e,pos2:t}),e in n&&t in n&&e!==t&&([r[e],r[t]]=[r[t],r[e]]),console.log({nbrd:JSON.stringify(r),pos1:e,pos2:t}),r},ae=100,ie=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,null],D=()=>{var e,t;let n=[...ie];for(let r=0;r<ae;r++){const o=(e=se(n))!=null?e:-1,s=(t=[o-4,o+1,o+4,o-1].filter(c=>c in n).sort(()=>Math.random()>=.5?-1:1)[0])!=null?t:-1;n=k(n,o,s)}return n},ce={board:D(),shuffling:!1},le=()=>{const n=JSON.parse(JSON.stringify(ce)),e=new J,t={root:n,emitter:e,dispatch:r=>{t.root=r(t.root),e.emit("update")}};return t},I=i.exports.createContext(null),S=()=>{const n=i.exports.useContext(I);if(!n)throw new Error("No StoreContext provided.");return n},ue=(n,e)=>{const t=S(),[r,o]=i.exports.useState(()=>n(t.root)),s=i.exports.useCallback(()=>{const c=n(t.root);(e?e(r,c):r!==c)&&o(c)},[]);return i.exports.useEffect(()=>(t.emitter.on("update",s),()=>{t.emitter.off("update",s)}),[]),r},de=({children:n})=>{const e=i.exports.useRef(le()).current;return a(I.Provider,{value:e,children:n})},g=n=>n,fe={error:{icon:K,iconStyle:g("errorIcon")},warning:{icon:U,iconStyle:g("warningIcon")},info:{icon:V,iconStyle:g("infoIcon")},success:{icon:X,iconStyle:g("successIcon")}},me=d(n=>({content:{padding:"1.5rem 1.5rem 0rem 1.5rem",minHeight:"6rem",display:"flex",alignItems:"center"},actions:{padding:"0.5rem 1.5rem 1rem 1.5rem",justifyContent:"center","& > .MuiButton-root":{minWidth:"8rem"}},icon:{flex:"0 0 auto",width:"3rem",height:"3rem"},message:{flex:"1 1",fontSize:"1rem",paddingLeft:"1.5rem",whiteSpace:"pre-wrap"},errorIcon:{color:n.palette.error.main},warningIcon:{color:n.palette.warning.main},infoIcon:{color:n.palette.info.main},successIcon:{color:n.palette.success.main}})),ge=({iconType:n,message:e,onClose:t,okButtonText:r})=>{const o=me(),{icon:s,iconStyle:c}=fe[n!=null?n:"info"];return f(B,{open:!0,maxWidth:"sm",fullWidth:!0,onClose:void 0,children:[f(_,{className:o.content,children:[a(s,{className:x(o.icon,o[c])}),a(N,{className:x(o.message),children:e})]}),a(T,{className:o.actions,children:a(y,{ref:l=>l==null?void 0:l.focus(),variant:"outlined",onClick:t,children:r!=null?r:"OK"})})]})},he=d(n=>({root:{opacity:0}})),pe=({onClose:n,showWhile:e})=>{const t=he();return i.exports.useEffect(()=>{e().then(n)},[]),a(B,{className:t.root,open:!0,fullScreen:!0})},xe={message:ge,blocker:pe},A=i.exports.createContext(null),P=()=>{const n=i.exports.useContext(A);if(!n)throw new Error("No DialogContext provided.");return n},ye=(n,e,t)=>r=>{const o=new Date().getTime().toString(16)+"-"+e.length;return new Promise((s,c)=>{const l=a(n,E(w({},r),{onClose:(...h)=>{console.log("onClose");const u=e.indexOf(l);u>=0?(e.splice(u,1),t(),s(h)):c("Illegal dialog close.")}}),o);e.push(l),t()})},Ce=({children:n})=>{const e=i.exports.useRef([]).current,[,t]=i.exports.useReducer(()=>[],[]),[r]=i.exports.useState(()=>Object.fromEntries(Object.entries(xe).map(([o,s])=>[o,ye(s,e,t)])));return f(A.Provider,{value:r,children:[n,e.map(o=>o)]})},Se=(n,e)=>C(t=>{console.log("DRAFT",JSON.stringify(t.board)),t.board=k(t.board,n,e)}),be=()=>C(n=>{n.board=D()}),we=d(n=>({root:{height:"calc(25% - 2px)",width:"calc(25% - 2px)",border:({n:e})=>e===null?"0px":"1px solid grey",margin:"1px",fontSize:"2em",fontWeight:"bold",backgroundColor:e=>e.n!==null?"white":"#ffffff00","&:hover":{backgroundColor:"green",color:"#FFF"}},right:{animation:"$rightAnimation 1s ease"},"@keyframes rightAnimation":{"0%":{transform:"translate(-100%, 0%)"},"100%":{transform:"translate(0%, 0%)"}},left:{animation:"$leftAnimation 1s ease"},"@keyframes leftAnimation":{"0%":{transform:"translate(100%, 0%)"},"100%":{transform:"translate(0%, 0%)"}},down:{animation:"$downAnimation 1s ease"},"@keyframes downAnimation":{"0%":{transform:"translate(0%, -100%)"},"100%":{transform:"translate(0%, 0%)"}},up:{animation:"$upAnimation 1s ease"},"@keyframes upAnimation":{"0%":{transform:"translate(0%, 100%)"},"100%":{transform:"translate(0%, 0%)"}}})),Ee=n=>{var u;const{n:e,pos:t}=n,r=we(n),o=S(),s=P(),[c,l]=i.exports.useState(t);i.exports.useEffect(()=>{(async()=>{o.root.shuffling?l(t):t!==c&&(await s.blocker({showWhile:async()=>{await new Promise(m=>setTimeout(m,1e3))}}),l(t))})()},[t]);const h=i.exports.useCallback(async()=>{const m=O(o.root.board,t);m!==null&&(o.dispatch(Se(t,m)),re(o.root.board)&&(await new Promise(j=>setTimeout(j,1e3)),await s.message({message:"\uFF11\uFF5E\uFF11\uFF15\u306E\u6570\u304C\u63C3\u3044\u307E\u3057\u305F\uFF01"})))},[t]);return a(y,{className:x(r.root,o.root.shuffling?null:(u={[-4]:r.up,[1]:r.right,[4]:r.down,[-1]:r.left}[t-c])!=null?u:null),onClick:h,disabled:e===null||O(o.root.board,t)===null,children:e})},Fe=d(n=>({root:{boxSizing:"content-box",padding:0,height:"24rem",width:"24rem",display:"flex",flexWrap:"wrap",border:"4px solid lightgrey",backgroundColor:"grey",backgroundImage:"repeating-linear-gradient(-45deg,#fff, #fff 7px,transparent 0, transparent 14px)"}})),ve=()=>{const n=Fe(),e=ue(t=>t.board);return a(q,{className:n.root,children:e.map((t,r)=>a(Ee,{n:t,pos:r},t!=null?t:0))})},$=n=>C(e=>{e.shuffling=n}),Be=d(n=>({button:{fontWeight:"bold",marginTop:"2rem"}}));function Ne(){const n=Be(),e=P(),{dispatch:t}=S(),r=i.exports.useCallback(async()=>{t($(!0)),t(be()),await e.message({iconType:"info",message:"\u30B7\u30E3\u30C3\u30D5\u30EB\u3057\u307E\u3057\u305F"}),t($(!1))},[]);return a(H,{maxWidth:"sm",children:f(G,{sx:{my:4},children:[a(N,{variant:"h4",component:"h1",gutterBottom:!0,children:"\uFF11\uFF15\u30D1\u30BA\u30EB\u30B5\u30F3\u30D7\u30EB"}),a(ve,{}),a(y,{className:`X ${n.button} X `,variant:"contained",size:"large",color:"primary",onClick:r,children:"\u30B7\u30E3\u30C3\u30D5\u30EB"})]})})}const Oe=Q({});Y.render(a(Z.StrictMode,{children:f(ee,{theme:Oe,children:[a(te,{}),a(oe,{children:a(de,{children:a(Ce,{children:a(Ne,{})})})})]})}),document.getElementById("root"));
